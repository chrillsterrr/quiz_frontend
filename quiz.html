<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"> <!-- We made our quiz in English, but this also allows for special characters etc-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Quiz</title>
    <link rel="stylesheet" href="styles.css"> <!-- linking our stylesheet -->
</head>
<body>
    <!-- Our "welcoming message" -->
    <div class="quiz-container" id="start-screen">
        <h2>Welcome to the Quiz!</h2>
        <p>Down below you can choose which quiz you want to do, where you get mulitple choice answers with a timer.<br> At the end of the test you will see your results.</p>
        <p>Choose a quiz to start:</p>
        <button onclick="startQuiz('capitals')">Capitals Quiz</button>
        <button onclick="startQuiz('languages')">Languages Quiz</button>
    </div>

    <div class="quiz-container" id="quiz-screen" style="display: none;">
        <div class="question" id="question">Loading...</div>
        <ul class="options" id="options"></ul>
        <button onclick="submitAnswer()">Submit</button>
        <!-- Timer Element Added -->
        <br>
        <div id="timer">Time Left: 10s</div>
        <br>
        <button id="cancel-quiz" onclick="cancelQuiz()">Cancel Quiz</button>
    </div>

    <div class="quiz-container" id="result-screen" style="display: none;">
        <div class="result" id="result"></div>
        <div class="review" id="review"></div>
        <!-- Go Back Button -->
        <button onclick="goBackToStart()">Go Back to Start</button>
    </div>

    <script> 
        // Our questions and the options to choose from and the right answer.
        const quizzes = {
            capitals: [
                { question: "What is the capital of France?", options: ["Berlin", "Madrid", "Paris", "Rome"], answer: "Paris" },
                { question: "What is the capital of Germany?", options: ["Berlin", "Vienna", "Brussels", "Amsterdam"], answer: "Berlin" },
                { question: "What is the capital of Italy?", options: ["Madrid", "Rome", "Lisbon", "Athens"], answer: "Rome" },
                { question: "What is the capital of Spain?", options: ["Madrid", "Barcelona", "Lisbon", "Paris"], answer: "Madrid" },
                { question: "What is the capital of Canada?", options: ["Toronto", "Vancouver", "Ottawa", "Montreal"], answer: "Ottawa" }
            ],
            // Our questions and the options to choose from and the right answer.
            languages: [
                { question: "What language is spoken in Brazil?", options: ["Spanish", "Portuguese", "French", "Italian"], answer: "Portuguese" },
                { question: "What is the official language of Japan?", options: ["Chinese", "Korean", "Japanese", "Thai"], answer: "Japanese" },
                { question: "What is the primary language spoken in Egypt?", options: ["Arabic", "Hebrew", "Persian", "Turkish"], answer: "Arabic" },
                { question: "Which language is predominantly spoken in Mexico?", options: ["English", "Spanish", "Portuguese", "French"], answer: "Spanish" },
                { question: "What language is primarily spoken in Russia?", options: ["Ukrainian", "Polish", "Russian", "Czech"], answer: "Russian" }
            ]
        };

        // our variables    
        let currentQuiz = []; //array
        let currentQuestionIndex = 0;
        let correctAnswers = 0;
        let userAnswers = []; //array
        let timer;
        let timeLeft;
        const startScreen = document.getElementById("start-screen");
        const quizScreen = document.getElementById("quiz-screen");
        const resultScreen = document.getElementById("result-screen");
        const questionElement = document.getElementById("question");
        const optionsElement = document.getElementById("options");
        const resultElement = document.getElementById("result");
        const reviewElement = document.getElementById("review");

        // function to start the quiz, when pressing a "topic"
        function startQuiz(topic) {
            currentQuiz = quizzes[topic];
            currentQuestionIndex = 0;
            correctAnswers = 0;
            userAnswers = [];
            shuffleQuestions();  // Shuffle questions when quiz starts
            startScreen.style.display = "none";
            quizScreen.style.display = "block";
            resultScreen.style.display = "none";
            loadQuestion();
        }

        // Our function to shuffle the questions
        function shuffleQuestions() {
            // Shuffle the questions array
            currentQuiz = currentQuiz.sort(() => Math.random() - 0.5);
            // Shuffle the options for each question
            currentQuiz.forEach(question => {
                question.options = question.options.sort(() => Math.random() - 0.5);
            });
        }

        // function for out timer, we've set it to 10
        function startTimer() {
            timeLeft = 10;
            document.getElementById("timer").textContent = `Time Left: ${timeLeft}s`;
            timer = setInterval(() => {
                timeLeft--;
                document.getElementById("timer").textContent = `Time Left: ${timeLeft}s`;
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    submitAnswer(true); // Automatically submit if the timer runs out
                }
            }, 1000);
        }

        // When you choose an answer or start the quiz, we load a question
        function loadQuestion() {
            if (currentQuestionIndex < currentQuiz.length) {
                clearInterval(timer);
                startTimer();
                const currentQuestion = currentQuiz[currentQuestionIndex];
                questionElement.textContent = currentQuestion.question;
                optionsElement.innerHTML = "";
                currentQuestion.options.forEach(option => {
                    const li = document.createElement("li");
                    li.innerHTML = `<label><input type='radio' name='quiz' value='${option}'> ${option}</label>`;
                    li.onclick = () => li.querySelector("input").checked = true;
                    optionsElement.appendChild(li);
                });
            } else {
                showResults();
            }
        }

        // our submit answer function
        function submitAnswer(autoSubmit = false) {
            clearInterval(timer);
            const selectedOption = document.querySelector('input[name="quiz"]:checked');
            if (!selectedOption && !autoSubmit) {
                alert("Please select an answer before submitting.");
                return; // forces an answer before moving forward without selecting an answer
            }
            const answerValue = selectedOption ? selectedOption.value : "(No answer)";
            userAnswers.push({
                question: currentQuiz[currentQuestionIndex].question,
                selected: answerValue,
                correct: currentQuiz[currentQuestionIndex].answer
            });
            if (answerValue === currentQuiz[currentQuestionIndex].answer) {
                correctAnswers++;
            }
            currentQuestionIndex++;
            loadQuestion(); //  Checks answer and then calls for the loadQuestion function
        }   

        // function to show results at the end
        function showResults() {
            quizScreen.style.display = "none";
            resultScreen.style.display = "block";
            resultElement.textContent = `You got ${correctAnswers} out of ${currentQuiz.length} correct (${((correctAnswers / currentQuiz.length) * 100).toFixed(2)}%)!`;
            reviewElement.innerHTML = "<h3>Review Your Answers:</h3>";
            userAnswers.forEach(answer => {
                const p = document.createElement("p");
                p.innerHTML = `<strong>${answer.question}</strong><br>Your Answer: ${answer.selected} <br> Correct Answer: ${answer.correct}`;
                p.style.color = answer.selected === answer.correct ? "green" : "red"; // we made some styles here for when getting a right or wrong answer.
                reviewElement.appendChild(p);
            });
        }

        // Function to cancel the quiz
        function cancelQuiz() {
            clearInterval(timer);
            quizScreen.style.display = "none";
            startScreen.style.display = "block";
        }

        // Function to go back to the start screen
        function goBackToStart() {
            resultScreen.style.display = "none";
            startScreen.style.display = "block";
        }
    </script>
</body>
</html>
